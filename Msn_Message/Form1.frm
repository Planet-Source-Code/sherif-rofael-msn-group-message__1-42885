VERSION 5.00
Begin VB.Form Form1 
   BackColor       =   &H00FF0000&
   BorderStyle     =   1  'Fixed Single
   Caption         =   "Msn Messenger"
   ClientHeight    =   1425
   ClientLeft      =   45
   ClientTop       =   435
   ClientWidth     =   2400
   Icon            =   "Form1.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   1425
   ScaleWidth      =   2400
   StartUpPosition =   3  'Windows Default
   Begin VB.TextBox Text1 
      Height          =   975
      Left            =   0
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   1
      Text            =   "Form1.frx":0E42
      Top             =   0
      Width           =   2415
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Send The Message"
      Height          =   495
      Left            =   0
      TabIndex        =   0
      Top             =   960
      Width           =   2415
   End
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'Description of the Purpose:
'================================
'This code will Send A Message You will Specify To All The
'Contacts You Are Opening A Conversation Window With Them.
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'Credits:
'=============
'The credits of this code Return To $e7en , A guy in pscode who
'first sent the code as  a snippets But it was unworking with
'a lot of people so i made a few changes and am now sending again
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'About me:
'==============
'I am Sherif Rofael ,  I am Studying Communications &
'Electronics Engineering (Only 1 year To Go )
'I Do Visual basic Just For Fun Or As a Hoppy.
'Mailto:sherif@vbcode.tk
'website:http://www.vbcode.tk
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'Api Declarations:
'=====================
Private Declare Function SendMessage Lib "user32" Alias "SendMessageA" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long
Private Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
Private Declare Function FindWindow Lib "user32" Alias "FindWindowA" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long
Private Declare Function SendMessageByString Lib "user32" Alias "SendMessageA" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As String) As Long
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'Constants:
'==============
Const XP = "RichEdit20W"
Const Win98 = "RichEdit20A"
Dim M As Boolean
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'The Main Program Function:
'=========================
Sub SendText(Text As String)
    Dim IMWindow, RichTB, RichTB2, SendButton As Long
    IMWindow = FindWindow("IMWindowClass", vbNullString) 'Get IM's Hwnd
    If IMWindow = 0 Then Exit Sub 'if no Im's open then exit
    RichTB = FindWindowEx(IMWindow, 0, XP, vbNullString) ' Get Chat Rooms Hwnd
    RichTB2 = FindWindowEx(IMWindow, RichTB, XP, vbNullString) 'Get Chat Box Hwnd
    SendButton = FindWindowEx(IMWindow, 0, "Button", "&Send") 'Get Send Button Hwnd
    SendMessageByString RichTB2, &HC, 0, Text 'Get Send Buttons Hwnd
    Call SendMessage(SendButton, &H100, &H20, 0&) 'Click the Button
    Call SendMessage(SendButton&, &H101, &H20, 0&)
End Sub
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'Sending The Message To all Users:
'=======================================
Private Sub Command1_Click()
Call SendText("This Message is Displayed In All Your Opened Conversation Windows" & vbCrLf & Text1.Text)
End Sub
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'===============================================================================================================================================================================
'Setting a Start Message In The Text Box:
'===========================================
Private Sub Form_Load()
M = True
End Sub
Private Sub Text1_Click()
If M = True Then
Text1.Text = ""
M = False
End If
End Sub
'===============================================================================================================================================================================
'===============================================================================================================================================================================

